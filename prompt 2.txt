Perfecto. Asumo el rol.

Voy a ser claro desde el principio: **PALEX no es una â€œweb con pelisâ€**, es un **sistema compartido con perspectiva doble**. Eso condiciona toda la arquitectura. Si esto se hace mal al inicio, luego duele. AsÃ­ que iremos despacio y bien.

No avanzo de fase sin tu validaciÃ³n.

---

# FASE 1 â€” ESTRUCTURA DEL PROYECTO (MVC liviano)

## ğŸ¯ Objetivo de esta fase

Definir una estructura **clara, escalable y comprensible**, sin frameworks, que:

* Separe lÃ³gica, datos y vistas
* Permita PWA sin hacks
* Sea mantenible aunque solo haya 2 usuarios
* No se convierta en un spaghetti PHP emocional (ya hay suficiente drama en el cine)

---

## ğŸ§  Principios arquitectÃ³nicos

1. **MVC simple, no dogmÃ¡tico**

   * Nada de sobreingenierÃ­a
   * Controllers finos, lÃ³gica en servicios
2. **Todo pasa por un Front Controller**

   * Un solo `index.php`
3. **Usuario siempre presente**

   * No existe acciÃ³n sin usuario
4. **Pensado para crecer**

   * API externa (TMDB)
   * MÃ¡s listas
   * MÃ¡s estados

---

## ğŸ“ Estructura propuesta

```
/palex
â”‚
â”œâ”€â”€ public/                  # RaÃ­z pÃºblica
â”‚   â”œâ”€â”€ index.php             # Front Controller
â”‚   â”œâ”€â”€ manifest.json         # PWA
â”‚   â”œâ”€â”€ sw.js                 # Service Worker
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”‚   â””â”€â”€ app.css
â”‚   â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”‚   â””â”€â”€ app.js
â”‚   â”‚   â””â”€â”€ images/
â”‚   â”‚       â””â”€â”€ placeholders/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ config.php        # Config general
â”‚   â”‚   â””â”€â”€ database.php      # ConexiÃ³n MySQL
â”‚   â”‚
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ Router.php
â”‚   â”‚   â”œâ”€â”€ Controller.php
â”‚   â”‚   â”œâ”€â”€ Model.php
â”‚   â”‚   â”œâ”€â”€ View.php
â”‚   â”‚   â”œâ”€â”€ Auth.php          # Login persistente
â”‚   â”‚   â””â”€â”€ Session.php
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ AuthController.php
â”‚   â”‚   â”œâ”€â”€ MovieController.php
â”‚   â”‚   â”œâ”€â”€ InteractionController.php
â”‚   â”‚   â””â”€â”€ ListController.php
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ User.php
â”‚   â”‚   â”œâ”€â”€ Movie.php
â”‚   â”‚   â”œâ”€â”€ Interaction.php
â”‚   â”‚   â””â”€â”€ List.php
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ MovieService.php
â”‚   â”‚   â”œâ”€â”€ InteractionService.php
â”‚   â”‚   â””â”€â”€ StateService.php  # Estados compartidos
â”‚   â”‚
â”‚   â””â”€â”€ views/
â”‚       â”œâ”€â”€ layouts/
â”‚       â”‚   â””â”€â”€ main.php
â”‚       â”œâ”€â”€ auth/
â”‚       â”œâ”€â”€ movies/
â”‚       â”œâ”€â”€ lists/
â”‚       â””â”€â”€ partials/
â”‚
â”œâ”€â”€ storage/
â”‚   â””â”€â”€ cache/                # Offline / PWA support
â”‚
â”œâ”€â”€ .htaccess
â””â”€â”€ README.md
```

---

## ğŸ” Flujo de ejecuciÃ³n

1. **Todas las peticiones entran por**

   ```
   public/index.php
   ```

2. El Router:

   * Lee la URL
   * Decide controlador + acciÃ³n

3. El Controller:

   * Valida usuario
   * Llama a servicios

4. Los Services:

   * Contienen la lÃ³gica real
   * Calculan estados compartidos
   * Preparan datos para la vista

5. La View:

   * Solo renderiza
   * Nada de SQL
   * Nada de lÃ³gica compleja

---

## ğŸ” AutenticaciÃ³n (visiÃ³n anticipada)

* Login **una sola vez**
* Cookie + sesiÃ³n
* `Auth::user()` disponible globalmente
* Hard limit:

  ```php
  if (count(users) > 2) abort();
  ```

Nada de registros pÃºblicos. Esto es un club privado.

---

## ğŸ¨ UX desde la estructura

Desde esta fase ya pensamos UX:

* Layout Ãºnico (`layouts/main.php`)
* Componentes reutilizables
* Colores y avatar del usuario disponibles en todas las vistas
* VisualizaciÃ³n comparativa siempre posible

---

## ğŸ“¦ Ventajas de esta estructura

âœ” FÃ¡cil de entender
âœ” No depende de frameworks
âœ” PWA-friendly
âœ” Preparada para TMDB
âœ” Ideal para solo 2 usuarios
âœ” No te odias dentro de 6 meses

---

## â“ ValidaciÃ³n requerida

Antes de avanzar necesito que confirmes:

1. Â¿Te parece correcta esta **estructura MVC liviana**?
2. Â¿Quieres **URLs limpias** tipo `/movies/123`?
3. Â¿Aceptamos que **toda lÃ³gica de estados compartidos** viva en `StateService`?

RespÃ³ndeme eso y **pasamos a FASE 2: Base de Datos**, donde empieza lo divertido (y lo peligroso).
